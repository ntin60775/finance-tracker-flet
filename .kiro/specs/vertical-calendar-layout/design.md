# Design Document: Vertical Calendar Layout

## Overview

–≠—Ç–æ—Ç –¥–∏–∑–∞–π–Ω –æ–ø–∏—Å—ã–≤–∞–µ—Ç —Ä–µ–æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—é –≥–ª–∞–≤–Ω–æ–≥–æ —ç–∫—Ä–∞–Ω–∞ Finance Tracker —Å –ø–µ—Ä–µ—Ö–æ–¥–æ–º –Ω–∞ –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–π –∫–∞–ª–µ–Ω–¥–∞—Ä—å –∏ –Ω–æ–≤—É—é 4-–∫–æ–ª–æ–Ω–æ—á–Ω—É—é –∫–æ–º–ø–æ–Ω–æ–≤–∫—É. –ö–ª—é—á–µ–≤—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è:

1. **–¢—Ä–∞–Ω—Å–ø–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–∞–ª–µ–Ω–¥–∞—Ä—è**: –¥–Ω–∏ –Ω–µ–¥–µ–ª–∏ —Ä–∞—Å–ø–æ–ª–∞–≥–∞—é—Ç—Å—è –ø–æ –≤–µ—Ä—Ç–∏–∫–∞–ª–∏ (7 —Å—Ç—Ä–æ–∫), –Ω–µ–¥–µ–ª–∏ –º–µ—Å—è—Ü–∞ - –ø–æ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª–∏ (4-6 —Å—Ç–æ–ª–±—Ü–æ–≤)
2. **–í–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ –≤—ã—Ç—è–Ω—É—Ç—ã–µ —è—á–µ–π–∫–∏**: aspect ratio ~1.3-1.5 –¥–ª—è –ª—É—á—à–µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞
3. **–ù–æ–≤–∞—è –∫–æ–º–ø–æ–Ω–æ–≤–∫–∞**: 4 –∫–æ–ª–æ–Ω–∫–∏ —Å –ø—Ä–æ–ø–æ—Ä—Ü–∏—è–º–∏ 2:2:4:3 (–≤—Å–µ–≥–æ 11 —á–∞—Å—Ç–µ–π)
4. **–û—Ç–¥–µ–ª—å–Ω–∞—è –∫–æ–ª–æ–Ω–∫–∞ –¥–ª—è –æ—Ç–ª–æ–∂–µ–Ω–Ω—ã—Ö –ø–ª–∞—Ç–µ–∂–µ–π**: –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ –∏–∑-–ø–æ–¥ –∫–∞–ª–µ–Ω–¥–∞—Ä—è –≤ –æ—Ç–¥–µ–ª—å–Ω—É—é –∫–æ–ª–æ–Ω–∫—É

–≠—Ç–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è —É–ª—É—á—à–∞—é—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞, –¥–µ–ª–∞—é—Ç —è—á–µ–π–∫–∏ –∫–∞–ª–µ–Ω–¥–∞—Ä—è –±–æ–ª–µ–µ —á–∏—Ç–∞–±–µ–ª—å–Ω—ã–º–∏ –∏ —É–ª—É—á—à–∞—é—Ç –≤–∏–∑—É–∞–ª—å–Ω—É—é –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—é –≥–ª–∞–≤–Ω–æ–≥–æ —ç–∫—Ä–∞–Ω–∞.

## Architecture

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã, —Ç—Ä–µ–±—É—é—â–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π

1. **CalendarWidget** (`src/finance_tracker/components/calendar_widget.py`)
   - –¢—Ä–∞–Ω—Å–ø–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ª–æ–≥–∏–∫–∏ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è —Å–µ—Ç–∫–∏
   - –ò–∑–º–µ–Ω–µ–Ω–∏–µ `_build_weekdays_header()` –¥–ª—è –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã—Ö –º–µ—Ç–æ–∫
   - –ò–∑–º–µ–Ω–µ–Ω–∏–µ `_update_calendar()` –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è —Å—Ç—Ä–æ–∫ –≤–º–µ—Å—Ç–æ —Å—Ç–æ–ª–±—Ü–æ–≤
   - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ aspect_ratio —è—á–µ–µ–∫

2. **HomeView** (`src/finance_tracker/views/home_view.py`)
   - –ò–∑–º–µ–Ω–µ–Ω–∏–µ –ø—Ä–æ–ø–æ—Ä—Ü–∏–π –∫–æ–ª–æ–Ω–æ–∫ —Å 2:3:2 –Ω–∞ 2:2:4:3
   - –ü–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ `PendingPaymentsWidget` –∏–∑ —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–π –∫–æ–ª–æ–Ω–∫–∏ –≤–æ –≤—Ç–æ—Ä—É—é
   - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä–∞—Å—á—ë—Ç–∞ —à–∏—Ä–∏–Ω—ã –∫–∞–ª–µ–Ω–¥–∞—Ä—è –¥–ª—è –Ω–æ–≤–æ–π –ø—Ä–æ–ø–æ—Ä—Ü–∏–∏ (4/11)

3. **CalendarLegend** (`src/finance_tracker/components/calendar_legend.py`)
   - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä–∞—Å—á—ë—Ç–∞ —à–∏—Ä–∏–Ω—ã –¥–ª—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è –Ω–æ–≤–æ–π —à–∏—Ä–∏–Ω–µ –∫–∞–ª–µ–Ω–¥–∞—Ä—è

### –ü–∞—Ç—Ç–µ—Ä–Ω—ã –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

- **–¢—Ä–∞–Ω—Å–ø–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –º–∞—Ç—Ä–∏—Ü—ã**: –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ month_matrix –∏–∑ —Ñ–æ—Ä–º–∞—Ç–∞ [week][day] –≤ [day][week]
- **–ê–¥–∞–ø—Ç–∏–≤–Ω–∞—è —à–∏—Ä–∏–Ω–∞**: –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π —Ä–∞—Å—á—ë—Ç —à–∏—Ä–∏–Ω—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ –Ω–æ–≤—ã—Ö –ø—Ä–æ–ø–æ—Ä—Ü–∏–π
- **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤**: –í—Å–µ –ø—É–±–ª–∏—á–Ω—ã–µ –º–µ—Ç–æ–¥—ã –∏ callbacks –æ—Å—Ç–∞—é—Ç—Å—è –Ω–µ–∏–∑–º–µ–Ω–Ω—ã–º–∏

## Components and Interfaces

### CalendarWidget

#### –ò–∑–º–µ–Ω—ë–Ω–Ω—ã–µ –º–µ—Ç–æ–¥—ã

```python
def _build_weekdays_header(self) -> ft.Row:
    """
    –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–∞ —Å –Ω–æ–º–µ—Ä–∞–º–∏ –Ω–µ–¥–µ–ª—å (–≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ).
    
    –í–º–µ—Å—Ç–æ –¥–Ω–µ–π –Ω–µ–¥–µ–ª–∏ (–ü–Ω-–í—Å) –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –Ω–æ–º–µ—Ä–∞ –Ω–µ–¥–µ–ª—å (–ù1, –ù2, ...).
    –ü–µ—Ä–≤—ã–π —ç–ª–µ–º–µ–Ω—Ç - –ø—É—Å—Ç–æ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏—è —Å –º–µ—Ç–∫–∞–º–∏ –¥–Ω–µ–π –Ω–µ–¥–µ–ª–∏.
    
    Returns:
        Row —Å –º–µ—Ç–∫–∞–º–∏ –Ω–µ–¥–µ–ª—å
    """
    # –û–ø—Ä–µ–¥–µ–ª—è–µ–º –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–µ–¥–µ–ª—å (–æ–±—ã—á–Ω–æ 5-6)
    month_matrix = self.calendar.monthdayscalendar(
        self.current_date.year, 
        self.current_date.month
    )
    num_weeks = len(month_matrix)
    
    return ft.Row(
        controls=[
            # –ü—É—Å—Ç–æ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏—è —Å –º–µ—Ç–∫–∞–º–∏ –¥–Ω–µ–π –Ω–µ–¥–µ–ª–∏
            ft.Container(width=50),
            # –ú–µ—Ç–∫–∏ –Ω–µ–¥–µ–ª—å
            *[
                ft.Container(
                    content=ft.Text(
                        f"–ù{i+1}", 
                        weight=ft.FontWeight.BOLD, 
                        color="secondary",
                        text_align=ft.TextAlign.CENTER
                    ),
                    expand=True,
                    alignment=ft.alignment.center,
                )
                for i in range(num_weeks)
            ]
        ],
    )

def _update_calendar(self):
    """
    –ü–µ—Ä–µ—Ä–∏—Å–æ–≤–∫–∞ —Å–µ—Ç–∫–∏ –∫–∞–ª–µ–Ω–¥–∞—Ä—è (—Ç—Ä–∞–Ω—Å–ø–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è).
    
    –°–æ–∑–¥–∞—ë—Ç 7 —Å—Ç—Ä–æ–∫ (–ø–æ –æ–¥–Ω–æ–π –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –¥–Ω—è –Ω–µ–¥–µ–ª–∏),
    –∫–∞–∂–¥–∞—è —Å—Ç—Ä–æ–∫–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç —è—á–µ–π–∫–∏ –¥–ª—è –≤—Å–µ—Ö –Ω–µ–¥–µ–ª—å –º–µ—Å—è—Ü–∞.
    """
    if not self.page:
        logger.warning("_update_calendar: self.page –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω!")
        return

    # –û–±–Ω–æ–≤–ª—è–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫
    months = [
        "–Ø–Ω–≤–∞—Ä—å", "–§–µ–≤—Ä–∞–ª—å", "–ú–∞—Ä—Ç", "–ê–ø—Ä–µ–ª—å", "–ú–∞–π", "–ò—é–Ω—å",
        "–ò—é–ª—å", "–ê–≤–≥—É—Å—Ç", "–°–µ–Ω—Ç—è–±—Ä—å", "–û–∫—Ç—è–±—Ä—å", "–ù–æ—è–±—Ä—å", "–î–µ–∫–∞–±—Ä—å"
    ]
    self.header_text.value = f"{months[self.current_date.month - 1]} {self.current_date.year}"

    # –û—á–∏—â–∞–µ–º —Å–µ—Ç–∫—É
    self.days_grid.controls.clear()

    # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Å–µ—Ç–∫—É –¥–Ω–µ–π (–¢–†–ê–ù–°–ü–û–ù–ò–†–û–í–ê–ù–ù–ê–Ø)
    month_matrix = self.calendar.monthdayscalendar(
        self.current_date.year, 
        self.current_date.month
    )
    
    weekdays = ["–ü–Ω", "–í—Ç", "–°—Ä", "–ß—Ç", "–ü—Ç", "–°–±", "–í—Å"]
    
    # –î–ª—è –∫–∞–∂–¥–æ–≥–æ –¥–Ω—è –Ω–µ–¥–µ–ª–∏ —Å–æ–∑–¥–∞—ë–º —Å—Ç—Ä–æ–∫—É
    for day_index, weekday in enumerate(weekdays):
        day_row = ft.Row(spacing=2)
        
        # –î–æ–±–∞–≤–ª—è–µ–º –º–µ—Ç–∫—É –¥–Ω—è –Ω–µ–¥–µ–ª–∏ —Å–ª–µ–≤–∞
        is_weekend = weekday in ["–°–±", "–í—Å"]
        day_row.controls.append(
            ft.Container(
                content=ft.Text(
                    weekday, 
                    weight=ft.FontWeight.BOLD,
                    color="secondary"
                ),
                width=50,
                alignment=ft.alignment.center_right,
                padding=ft.padding.only(right=5),
                # –í—ã–¥–µ–ª—è–µ–º –≤—ã—Ö–æ–¥–Ω—ã–µ —Å–≤–µ—Ç–ª—ã–º —Ñ–æ–Ω–æ–º
                bgcolor=ft.Colors.BLUE_50 if is_weekend else None,
                border_radius=5,
            )
        )
        
        # –î–æ–±–∞–≤–ª—è–µ–º —è—á–µ–π–∫–∏ –¥–ª—è –∫–∞–∂–¥–æ–π –Ω–µ–¥–µ–ª–∏
        for week in month_matrix:
            day = week[day_index]
            if day == 0:
                # –ü—É—Å—Ç–∞—è —è—á–µ–π–∫–∞
                day_row.controls.append(
                    ft.Container(
                        expand=True,
                        aspect_ratio=0.7,  # –í–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ –≤—ã—Ç—è–Ω—É—Ç–∞—è (1/1.4 ‚âà 0.7)
                    )
                )
            else:
                # –Ø—á–µ–π–∫–∞ —Å –¥–Ω—ë–º
                current_day_date = datetime.date(
                    self.current_date.year, 
                    self.current_date.month, 
                    day
                )
                day_row.controls.append(
                    self._build_day_cell(current_day_date)
                )
        
        self.days_grid.controls.append(day_row)
    
    self.update()

def _build_day_cell(self, date_obj: datetime.date) -> ft.Container:
    """
    –°–æ–∑–¥–∞–Ω–∏–µ —è—á–µ–π–∫–∏ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –¥–Ω—è.
    
    Args:
        date_obj: –î–∞—Ç–∞ –¥–ª—è —è—á–µ–π–∫–∏
        
    Returns:
        Container —Å —Å–æ–¥–µ—Ä–∂–∏–º—ã–º —è—á–µ–π–∫–∏
    """
    is_selected = self.selected_date == date_obj
    is_today = date_obj == datetime.date.today()
    is_cash_gap = date_obj in self.cash_gaps
    has_overdue_payment = self._has_overdue_payment(date_obj)
    
    # –°–æ–±–∏—Ä–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –¥–ª—è –¥–Ω—è
    indicators = self._get_indicators_for_date(date_obj)
    
    # –°—Ç–∏–ª–∏–∑–∞—Ü–∏—è
    if has_overdue_payment:
        bg_color = ft.Colors.RED_100
        text_color = ft.Colors.BLACK
    elif is_cash_gap:
        bg_color = ft.Colors.AMBER_100
        text_color = ft.Colors.BLACK
    else:
        bg_color = "primaryContainer" if is_selected else "surfaceVariant"
        if is_selected:
            text_color = "onPrimaryContainer"
        elif is_today:
            text_color = "primary"
        else:
            text_color = "onSurface"
    
    # –†–∞–º–∫–∞ –¥–ª—è –≤—ã–¥–µ–ª–µ–Ω–∏—è
    if has_overdue_payment:
        border = ft.border.all(2, ft.Colors.RED_700)
    elif is_selected:
        border = ft.border.all(3, ft.Colors.GREEN_700)
    elif is_today:
        border = ft.border.all(2, "primary")
    else:
        border = None

    # –§–æ—Ä–º–∏—Ä—É–µ–º tooltip
    tooltip_text = None
    if has_overdue_payment:
        tooltip_text = "–ü—Ä–æ—Å—Ä–æ—á–µ–Ω–Ω—ã–π –ø–ª–∞—Ç—ë–∂ –ø–æ –∫—Ä–µ–¥–∏—Ç—É!"
    elif is_cash_gap:
        tooltip_text = "–ö–∞—Å—Å–æ–≤—ã–π —Ä–∞–∑—Ä—ã–≤!"
    
    # –†–∞–∑–±–∏–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –Ω–∞ —Å—Ç—Ä–æ–∫–∏, –µ—Å–ª–∏ –∏—Ö –±–æ–ª—å—à–µ 3
    indicator_rows = []
    if len(indicators) <= 3:
        indicator_rows.append(
            ft.Row(
                controls=indicators,
                alignment=ft.MainAxisAlignment.CENTER,
                spacing=2,
            )
        )
    else:
        # –†–∞–∑–±–∏–≤–∞–µ–º –Ω–∞ —Å—Ç—Ä–æ–∫–∏ –ø–æ 3 –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞
        for i in range(0, len(indicators), 3):
            indicator_rows.append(
                ft.Row(
                    controls=indicators[i:i+3],
                    alignment=ft.MainAxisAlignment.CENTER,
                    spacing=2,
                )
            )
    
    return ft.Container(
        content=ft.Column(
            controls=[
                ft.Text(
                    str(date_obj.day),
                    weight=ft.FontWeight.BOLD if is_today or is_selected else ft.FontWeight.NORMAL,
                    color=text_color,
                    size=14
                ),
                ft.Column(
                    controls=indicator_rows,
                    spacing=1,
                    alignment=ft.MainAxisAlignment.CENTER,
                )
            ],
            alignment=ft.MainAxisAlignment.CENTER,
            spacing=2,
            horizontal_alignment=ft.CrossAxisAlignment.CENTER,
        ),
        expand=True,
        aspect_ratio=0.7,  # –í–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ –≤—ã—Ç—è–Ω—É—Ç–∞—è (—à–∏—Ä–∏–Ω–∞/–≤—ã—Å–æ—Ç–∞ = 0.7)
        bgcolor=bg_color,
        border_radius=8,
        border=border,
        on_click=lambda _, d=date_obj: self._on_day_click(d),
        ink=True,
        tooltip=tooltip_text
    )
```

#### –ù–µ–∏–∑–º–µ–Ω—ë–Ω–Ω—ã–µ –º–µ—Ç–æ–¥—ã

- `set_transactions()` - –æ—Å—Ç–∞—ë—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π
- `_get_indicators_for_date()` - –æ—Å—Ç–∞—ë—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π
- `_has_overdue_payment()` - –æ—Å—Ç–∞—ë—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π
- `_on_day_click()` - –æ—Å—Ç–∞—ë—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π
- `select_date()` - –æ—Å—Ç–∞—ë—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π
- –í—Å–µ –º–µ—Ç–æ–¥—ã –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö (`_update_cash_gaps()`, `_update_pending_payments()`, `_update_loan_payments()`)

### HomeView

#### –ò–∑–º–µ–Ω—ë–Ω–Ω—ã–π layout

```python
# –í –º–µ—Ç–æ–¥–µ __init__()

# Layout —Å –Ω–æ–≤—ã–º–∏ –ø—Ä–æ–ø–æ—Ä—Ü–∏—è–º–∏
self.controls = [
    ft.Row(
        controls=[
            # –ö–æ–ª–æ–Ω–∫–∞ 1 (2/11): –ü–ª–∞–Ω–æ–≤—ã–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
            ft.Column(
                controls=[
                    self.planned_widget
                ],
                expand=2,  # –ë—ã–ª–æ: expand=2
                spacing=20,
                scroll=ft.ScrollMode.AUTO,
                alignment=ft.MainAxisAlignment.START
            ),
            ft.VerticalDivider(width=1),
            
            # –ö–æ–ª–æ–Ω–∫–∞ 2 (2/11): –û—Ç–ª–æ–∂–µ–Ω–Ω—ã–µ –ø–ª–∞—Ç–µ–∂–∏ (–ù–û–í–ê–Ø –ü–û–ó–ò–¶–ò–Ø)
            ft.Column(
                controls=[
                    self.pending_payments_widget
                ],
                expand=2,  # –ù–û–í–ê–Ø –ö–û–õ–û–ù–ö–ê
                spacing=20,
                scroll=ft.ScrollMode.AUTO,
                alignment=ft.MainAxisAlignment.START
            ),
            ft.VerticalDivider(width=1),
            
            # –ö–æ–ª–æ–Ω–∫–∞ 3 (4/11): –ö–∞–ª–µ–Ω–¥–∞—Ä—å –∏ –ª–µ–≥–µ–Ω–¥–∞
            ft.Column(
                controls=[
                    self.calendar_widget,
                    self.legend,
                    # pending_payments_widget –£–î–ê–õ–Å–ù –æ—Ç—Å—é–¥–∞
                ],
                expand=4,  # –ë—ã–ª–æ: expand=3
                spacing=20,
                scroll=ft.ScrollMode.AUTO,
                alignment=ft.MainAxisAlignment.START
            ),
            ft.VerticalDivider(width=1),
            
            # –ö–æ–ª–æ–Ω–∫–∞ 4 (3/11): –ü–∞–Ω–µ–ª—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
            ft.Column(
                controls=[
                    self.transactions_panel
                ],
                expand=3,  # –ë—ã–ª–æ: expand=2
                scroll=ft.ScrollMode.AUTO,
                alignment=ft.MainAxisAlignment.START
            )
        ],
        expand=True,
        spacing=20,
        alignment=ft.MainAxisAlignment.START,
        vertical_alignment=ft.CrossAxisAlignment.START
    )
]
```

#### –û–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–π —Ä–∞—Å—á—ë—Ç —à–∏—Ä–∏–Ω—ã –∫–∞–ª–µ–Ω–¥–∞—Ä—è

```python
def _calculate_calendar_width(self) -> int:
    """
    –í—ã—á–∏—Å–ª—è–µ—Ç —à–∏—Ä–∏–Ω—É –∫–∞–ª–µ–Ω–¥–∞—Ä—è –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–∞–∑–º–µ—Ä–æ–≤ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∏ layout.
    
    Returns:
        –ü—Ä–∏–±–ª–∏–∑–∏—Ç–µ–ª—å–Ω–∞—è —à–∏—Ä–∏–Ω–∞ –∫–∞–ª–µ–Ω–¥–∞—Ä—è –≤ –ø–∏–∫—Å–µ–ª—è—Ö
    """
    try:
        # –ü–æ–ª—É—á–∞–µ–º —à–∏—Ä–∏–Ω—É —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        if hasattr(self.page, 'width') and self.page.width:
            page_width = self.page.width
        else:
            page_width = 1200  # Fallback
        
        # –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–∞—è –∫–æ–ª–æ–Ω–∫–∞ –∑–∞–Ω–∏–º–∞–µ—Ç 4/11 –æ—Ç –æ–±—â–µ–π —à–∏—Ä–∏–Ω—ã
        # –ö–æ–ª–æ–Ω–∫–∏: expand=2, expand=2, expand=4, expand=3
        # –û–±—â–∏–π expand = 2 + 2 + 4 + 3 = 11
        center_column_ratio = 4 / 11
        
        # –í—ã—á–∏—Ç–∞–µ–º –æ—Ç—Å—Ç—É–ø—ã –∏ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª–∏
        # spacing –º–µ–∂–¥—É –∫–æ–ª–æ–Ω–∫–∞–º–∏: 20px * 3 = 60px
        # VerticalDivider: width=1 * 3 = 3px
        # padding –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞: –ø—Ä–∏–º–µ—Ä–Ω–æ 20px —Å –∫–∞–∂–¥–æ–π —Å—Ç–æ—Ä–æ–Ω—ã = 40px
        total_spacing = 60 + 3 + 40  # 103px
        
        # –í—ã—á–∏—Å–ª—è–µ–º –¥–æ—Å—Ç—É–ø–Ω—É—é —à–∏—Ä–∏–Ω—É –¥–ª—è –∫–æ–ª–æ–Ω–æ–∫
        available_width = page_width - total_spacing
        
        # –®–∏—Ä–∏–Ω–∞ —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–π –∫–æ–ª–æ–Ω–∫–∏
        center_column_width = int(available_width * center_column_ratio)
        
        # –ö–∞–ª–µ–Ω–¥–∞—Ä—å –∑–∞–Ω–∏–º–∞–µ—Ç –ø–æ—á—Ç–∏ –≤—Å—é —à–∏—Ä–∏–Ω—É —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–π –∫–æ–ª–æ–Ω–∫–∏
        # –í—ã—á–∏—Ç–∞–µ–º –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –æ—Ç—Å—Ç—É–ø—ã –∫–æ–ª–æ–Ω–∫–∏ (–ø—Ä–∏–º–µ—Ä–Ω–æ 20px)
        calendar_width = center_column_width - 20
        
        logger.debug(
            f"–í—ã—á–∏—Å–ª–µ–Ω–∞ —à–∏—Ä–∏–Ω–∞ –∫–∞–ª–µ–Ω–¥–∞—Ä—è: {calendar_width}px "
            f"(—Å—Ç—Ä–∞–Ω–∏—Ü–∞: {page_width}px, —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–∞—è –∫–æ–ª–æ–Ω–∫–∞: {center_column_width}px)"
        )
        
        return max(calendar_width, 300)  # –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —à–∏—Ä–∏–Ω–∞ 300px
        
    except Exception as e:
        logger.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –≤—ã—á–∏—Å–ª–µ–Ω–∏–∏ —à–∏—Ä–∏–Ω—ã –∫–∞–ª–µ–Ω–¥–∞—Ä—è: {e}")
        return 500  # Fallback
```

## Data Models

–ò–∑–º–µ–Ω–µ–Ω–∏–π –≤ –º–æ–¥–µ–ª—è—Ö –¥–∞–Ω–Ω—ã—Ö –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è. –í—Å–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –º–æ–¥–µ–ª–∏ –æ—Å—Ç–∞—é—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π:
- `TransactionDB`
- `PlannedOccurrenceDB`
- `PendingPaymentDB`
- `LoanPaymentDB`

## Correctness Properties

*–°–≤–æ–π—Å—Ç–≤–æ (property) - —ç—Ç–æ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞ –∏–ª–∏ –ø–æ–≤–µ–¥–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –¥–æ–ª–∂–Ω–æ –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è –¥–ª—è –≤—Å–µ—Ö –≤–∞–ª–∏–¥–Ω—ã—Ö –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º—ã. –°–≤–æ–π—Å—Ç–≤–∞ —Å–ª—É–∂–∞—Ç –º–æ—Å—Ç–æ–º –º–µ–∂–¥—É —á–µ–ª–æ–≤–µ–∫–æ-—á–∏—Ç–∞–µ–º—ã–º–∏ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è–º–∏ –∏ –º–∞—à–∏–Ω–Ω–æ-–ø—Ä–æ–≤–µ—Ä—è–µ–º—ã–º–∏ –≥–∞—Ä–∞–Ω—Ç–∏—è–º–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏.*

### Property 1: –¢—Ä–∞–Ω—Å–ø–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–∞–ª–µ–Ω–¥–∞—Ä–Ω–æ–π —Å–µ—Ç–∫–∏

*For any* –º–µ—Å—è—Ü –∏ –≥–æ–¥, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–æ–∫ –≤ –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ–º –∫–∞–ª–µ–Ω–¥–∞—Ä–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —Ä–∞–≤–Ω–æ 7 (–¥–Ω–∏ –Ω–µ–¥–µ–ª–∏), –∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç–æ–ª–±—Ü–æ–≤ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —Ä–∞–≤–Ω–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –Ω–µ–¥–µ–ª—å –≤ —ç—Ç–æ–º –º–µ—Å—è—Ü–µ (4-6).

**Validates: Requirements 1.1, 1.2**

### Property 2: –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤—Å–µ—Ö –¥–Ω–µ–π –º–µ—Å—è—Ü–∞

*For any* –º–µ—Å—è—Ü –∏ –≥–æ–¥, —Å—É–º–º–∞ –≤—Å–µ—Ö –Ω–µ–ø—É—Å—Ç—ã—Ö —è—á–µ–µ–∫ –≤ —Ç—Ä–∞–Ω—Å–ø–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–º –∫–∞–ª–µ–Ω–¥–∞—Ä–µ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å —Ä–∞–≤–Ω–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –¥–Ω–µ–π –≤ —ç—Ç–æ–º –º–µ—Å—è—Ü–µ.

**Validates: Requirements 1.5, 10.1**

### Property 3: –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –ø–æ–∑–∏—Ü–∏–π –ø—É—Å—Ç—ã—Ö —è—á–µ–µ–∫

*For any* –º–µ—Å—è—Ü, –µ—Å–ª–∏ –ø–µ—Ä–≤—ã–π –¥–µ–Ω—å –º–µ—Å—è—Ü–∞ –ø—Ä–∏—Ö–æ–¥–∏—Ç—Å—è –Ω–∞ –¥–µ–Ω—å –Ω–µ–¥–µ–ª–∏ N (–≥–¥–µ –ü–Ω=0, –í—Å=6), —Ç–æ –≤ —Å—Ç—Ä–æ–∫–∞—Ö 0..N-1 –ø–µ—Ä–≤—ã–π —Å—Ç–æ–ª–±–µ—Ü –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å –ø—É—Å—Ç—ã–µ —è—á–µ–π–∫–∏.

**Validates: Requirements 1.5**

### Property 4: –ö–ª–∏–∫ –Ω–∞ —è—á–µ–π–∫—É –≤—ã–∑—ã–≤–∞–µ—Ç callback

*For any* –Ω–µ–ø—É—Å—Ç–∞—è —è—á–µ–π–∫–∞ –∫–∞–ª–µ–Ω–¥–∞—Ä—è, –∫–ª–∏–∫ –Ω–∞ –Ω–µ—ë –¥–æ–ª–∂–µ–Ω –≤—ã–∑—ã–≤–∞—Ç—å callback `on_date_selected` —Å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–π –¥–∞—Ç–æ–π.

**Validates: Requirements 1.6, 7.1**

### Property 5: –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –¥–ª—è –≤—Å–µ—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π

*For any* –¥–∞—Ç–∞ —Å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è–º–∏, —è—á–µ–π–∫–∞ —ç—Ç–æ–π –¥–∞—Ç—ã –¥–æ–ª–∂–Ω–∞ —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã (–∑–µ–ª—ë–Ω—ã–µ —Ç–æ—á–∫–∏ –¥–ª—è –¥–æ—Ö–æ–¥–æ–≤, –∫—Ä–∞—Å–Ω—ã–µ –¥–ª—è —Ä–∞—Å—Ö–æ–¥–æ–≤).

**Validates: Requirements 1.7, 7.3**

### Property 6: –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –¥–ª—è –≤—Å–µ—Ö –ø–ª–∞–Ω–æ–≤—ã—Ö –≤—Ö–æ–∂–¥–µ–Ω–∏–π

*For any* –¥–∞—Ç–∞ —Å –ø–ª–∞–Ω–æ–≤—ã–º–∏ –≤—Ö–æ–∂–¥–µ–Ω–∏—è–º–∏, —è—á–µ–π–∫–∞ —ç—Ç–æ–π –¥–∞—Ç—ã –¥–æ–ª–∂–Ω–∞ —Å–æ–¥–µ—Ä–∂–∞—Ç—å –æ—Ä–∞–Ω–∂–µ–≤—ã–π —Ä–æ–º–± (‚óÜ).

**Validates: Requirements 1.7, 7.4, 10.2**

### Property 7: –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –¥–ª—è –≤—Å–µ—Ö –æ—Ç–ª–æ–∂–µ–Ω–Ω—ã—Ö –ø–ª–∞—Ç–µ–∂–µ–π

*For any* –¥–∞—Ç–∞ —Å –æ—Ç–ª–æ–∂–µ–Ω–Ω—ã–º–∏ –ø–ª–∞—Ç–µ–∂–∞–º–∏, —è—á–µ–π–∫–∞ —ç—Ç–æ–π –¥–∞—Ç—ã –¥–æ–ª–∂–Ω–∞ —Å–æ–¥–µ—Ä–∂–∞—Ç—å –∏–∫–æ–Ω–∫—É üìã.

**Validates: Requirements 1.7, 7.5, 10.3**

### Property 8: –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –¥–ª—è –≤—Å–µ—Ö –ø–ª–∞—Ç–µ–∂–µ–π –ø–æ –∫—Ä–µ–¥–∏—Ç–∞–º

*For any* –¥–∞—Ç–∞ —Å –ø–ª–∞—Ç–µ–∂–∞–º–∏ –ø–æ –∫—Ä–µ–¥–∏—Ç–∞–º, —è—á–µ–π–∫–∞ —ç—Ç–æ–π –¥–∞—Ç—ã –¥–æ–ª–∂–Ω–∞ —Å–æ–¥–µ—Ä–∂–∞—Ç—å –∏–∫–æ–Ω–∫—É üí≥.

**Validates: Requirements 1.7, 7.6, 10.4**

### Property 9: –°—Ç–∏–ª–∏–∑–∞—Ü–∏—è –∫–∞—Å—Å–æ–≤—ã—Ö —Ä–∞–∑—Ä—ã–≤–æ–≤

*For any* –¥–∞—Ç–∞ —Å –∫–∞—Å—Å–æ–≤—ã–º —Ä–∞–∑—Ä—ã–≤–æ–º, —è—á–µ–π–∫–∞ —ç—Ç–æ–π –¥–∞—Ç—ã –¥–æ–ª–∂–Ω–∞ –∏–º–µ—Ç—å –∂—ë–ª—Ç—ã–π/–æ—Ä–∞–Ω–∂–µ–≤—ã–π —Ñ–æ–Ω (AMBER_100).

**Validates: Requirements 7.7, 10.5**

### Property 10: –°—Ç–∏–ª–∏–∑–∞—Ü–∏—è –ø—Ä–æ—Å—Ä–æ—á–µ–Ω–Ω—ã—Ö –ø–ª–∞—Ç–µ–∂–µ–π

*For any* –¥–∞—Ç–∞ —Å –ø—Ä–æ—Å—Ä–æ—á–µ–Ω–Ω—ã–º –ø–ª–∞—Ç–µ–∂–æ–º –ø–æ –∫—Ä–µ–¥–∏—Ç—É, —è—á–µ–π–∫–∞ —ç—Ç–æ–π –¥–∞—Ç—ã –¥–æ–ª–∂–Ω–∞ –∏–º–µ—Ç—å –∫—Ä–∞—Å–Ω—ã–π —Ñ–æ–Ω (RED_100) –∏ –∫—Ä–∞—Å–Ω—É—é —Ä–∞–º–∫—É.

**Validates: Requirements 7.8**

### Property 11: –°—Ç–∏–ª–∏–∑–∞—Ü–∏—è —Ç–µ–∫—É—â–µ–≥–æ –¥–Ω—è

*For any* –∫–∞–ª–µ–Ω–¥–∞—Ä—å, —è—á–µ–π–∫–∞ —Ç–µ–∫—É—â–µ–≥–æ –¥–Ω—è (today) –¥–æ–ª–∂–Ω–∞ –∏–º–µ—Ç—å —Å–∏–Ω—é—é —Ä–∞–º–∫—É.

**Validates: Requirements 7.9**

### Property 12: –°—Ç–∏–ª–∏–∑–∞—Ü–∏—è –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –¥–Ω—è

*For any* –≤—ã–±—Ä–∞–Ω–Ω–∞—è –¥–∞—Ç–∞, —è—á–µ–π–∫–∞ —ç—Ç–æ–π –¥–∞—Ç—ã –¥–æ–ª–∂–Ω–∞ –∏–º–µ—Ç—å –∑–µ–ª—ë–Ω—É—é —Ä–∞–º–∫—É –∏ primaryContainer —Ñ–æ–Ω.

**Validates: Requirements 7.10**

### Property 13: –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤

*For any* —è—á–µ–π–∫–∞ —Å –±–æ–ª–µ–µ —á–µ–º 3 –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞–º–∏, –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Ä–∞–∑–±–∏—Ç—ã –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å—Ç—Ä–æ–∫ –ø–æ 3 –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞ –≤ –∫–∞–∂–¥–æ–π.

**Validates: Requirements 2.6**

### Property 14: –ü—Ä–æ–ø–æ—Ä—Ü–∏–∏ –∫–æ–ª–æ–Ω–æ–∫ Home_View

*For any* Home_View, –∫–æ–ª–æ–Ω–∫–∏ –¥–æ–ª–∂–Ω—ã –∏–º–µ—Ç—å expand –∑–Ω–∞—á–µ–Ω–∏—è 2, 2, 4, 3 (–≤ –ø–æ—Ä—è–¥–∫–µ —Å–ª–µ–≤–∞ –Ω–∞–ø—Ä–∞–≤–æ), —á—Ç–æ –¥–∞—ë—Ç –ø—Ä–æ–ø–æ—Ä—Ü–∏–∏ 2/11, 2/11, 4/11, 3/11.

**Validates: Requirements 4.1**

### Property 15: –†–∞—Å—á—ë—Ç —à–∏—Ä–∏–Ω—ã –∫–∞–ª–µ–Ω–¥–∞—Ä—è

*For any* —à–∏—Ä–∏–Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã, —à–∏—Ä–∏–Ω–∞ –∫–∞–ª–µ–Ω–¥–∞—Ä—è –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å —Ä–∞–≤–Ω–∞ (page_width - spacing - dividers) √ó (4/11) - padding, –Ω–æ –Ω–µ –º–µ–Ω–µ–µ 300px.

**Validates: Requirements 6.1, 6.2**

### Property 16: –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —à–∏—Ä–∏–Ω—ã –ª–µ–≥–µ–Ω–¥—ã –∏ –∫–∞–ª–µ–Ω–¥–∞—Ä—è

*For any* Calendar_Widget –∏ Calendar_Legend –≤ –æ–¥–Ω–æ–π –∫–æ–ª–æ–Ω–∫–µ, –∏—Ö —à–∏—Ä–∏–Ω—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Ä–∞–≤–Ω—ã.

**Validates: Requirements 6.4, 8.2**

## Error Handling

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è page

```python
if not self.page:
    logger.warning("_update_calendar: self.page –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω!")
    return
```

–ï—Å–ª–∏ `page` –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, –∫–∞–ª–µ–Ω–¥–∞—Ä—å –Ω–µ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –≤–∏–∑—É–∞–ª—å–Ω–æ, –Ω–æ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ (`selected_date`) —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è.

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã—Ö –¥–∞—Ç

```python
try:
    current_day_date = datetime.date(
        self.current_date.year, 
        self.current_date.month, 
        day
    )
except ValueError as e:
    logger.error(f"–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –¥–∞—Ç–∞: {e}")
    continue  # –ü—Ä–æ–ø—É—Å–∫–∞–µ–º –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—É—é —è—á–µ–π–∫—É
```

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ —Ä–∞—Å—á—ë—Ç–∞ —à–∏—Ä–∏–Ω—ã

```python
except Exception as e:
    logger.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –≤—ã—á–∏—Å–ª–µ–Ω–∏–∏ —à–∏—Ä–∏–Ω—ã –∫–∞–ª–µ–Ω–¥–∞—Ä—è: {e}")
    return 500  # Fallback –∫ –±–µ–∑–æ–ø–∞—Å–Ω–æ–º—É –∑–Ω–∞—á–µ–Ω–∏—é
```

## Testing Strategy

### Unit Tests

**–§–∞–π–ª:** `tests/test_vertical_calendar.py`

1. **–¢–µ—Å—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ–≥–æ –∫–∞–ª–µ–Ω–¥–∞—Ä—è**
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è 7 —Å—Ç—Ä–æ–∫ (–¥–Ω–∏ –Ω–µ–¥–µ–ª–∏)
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Å—Ç–æ–ª–±—Ü–æ–≤ (–Ω–µ–¥–µ–ª—å)
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –º–µ—Ç–æ–∫ –¥–Ω–µ–π –Ω–µ–¥–µ–ª–∏ —Å–ª–µ–≤–∞

2. **–¢–µ—Å—Ç –ø—É—Å—Ç—ã—Ö —è—á–µ–µ–∫**
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –ø–æ–∑–∏—Ü–∏–π –ø—É—Å—Ç—ã—Ö —è—á–µ–µ–∫ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –º–µ—Å—è—Ü–µ–≤
   - –¢–µ—Å—Ç –¥–ª—è –º–µ—Å—è—Ü–µ–≤, –Ω–∞—á–∏–Ω–∞—é—â–∏—Ö—Å—è —Å —Ä–∞–∑–Ω—ã—Ö –¥–Ω–µ–π –Ω–µ–¥–µ–ª–∏

3. **–¢–µ—Å—Ç aspect_ratio —è—á–µ–µ–∫**
   - –ü—Ä–æ–≤–µ—Ä–∫–∞, —á—Ç–æ —è—á–µ–π–∫–∏ –∏–º–µ—é—Ç aspect_ratio = 0.7 (–≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ –≤—ã—Ç—è–Ω—É—Ç—ã–µ)

4. **–¢–µ—Å—Ç –≤—ã–¥–µ–ª–µ–Ω–∏—è –≤—ã—Ö–æ–¥–Ω—ã—Ö**
   - –ü—Ä–æ–≤–µ—Ä–∫–∞, —á—Ç–æ –º–µ—Ç–∫–∏ —Å—É–±–±–æ—Ç—ã –∏ –≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å—è –∏–º–µ—é—Ç —Ñ–æ–Ω BLUE_50

5. **–¢–µ—Å—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Å—Ç—Ä–æ–∫ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤**
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–±–∏–µ–Ω–∏—è –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤ –Ω–∞ —Å—Ç—Ä–æ–∫–∏ –ø—Ä–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ > 3

**–§–∞–π–ª:** `tests/test_home_view_layout.py`

1. **–¢–µ—Å—Ç –Ω–æ–≤—ã—Ö –ø—Ä–æ–ø–æ—Ä—Ü–∏–π –∫–æ–ª–æ–Ω–æ–∫**
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ expand –∑–Ω–∞—á–µ–Ω–∏–π: 2, 2, 4, 3
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è 4 –∫–æ–ª–æ–Ω–æ–∫

2. **–¢–µ—Å—Ç –ø–æ–∑–∏—Ü–∏–∏ Pending_Payments_Widget**
   - –ü—Ä–æ–≤–µ—Ä–∫–∞, —á—Ç–æ –≤–∏–¥–∂–µ—Ç –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤–æ –≤—Ç–æ—Ä–æ–π –∫–æ–ª–æ–Ω–∫–µ
   - –ü—Ä–æ–≤–µ—Ä–∫–∞, —á—Ç–æ –≤–∏–¥–∂–µ—Ç –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –≤ —Ç—Ä–µ—Ç—å–µ–π –∫–æ–ª–æ–Ω–∫–µ

3. **–¢–µ—Å—Ç —Ä–∞—Å—á—ë—Ç–∞ —à–∏—Ä–∏–Ω—ã –∫–∞–ª–µ–Ω–¥–∞—Ä—è**
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–æ—Ä–º—É–ª—ã —Ä–∞—Å—á—ë—Ç–∞ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —à–∏—Ä–∏–Ω —Å—Ç—Ä–∞–Ω–∏—Ü—ã
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π —à–∏—Ä–∏–Ω—ã 300px

### Property-Based Tests

**–§–∞–π–ª:** `tests/test_vertical_calendar_properties.py`

1. **Property 1-3: –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–∞–ª–µ–Ω–¥–∞—Ä—è**
   - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–ª—É—á–∞–π–Ω—ã—Ö –º–µ—Å—è—Ü–µ–≤ –∏ –≥–æ–¥–æ–≤
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ —Ç—Ä–∞–Ω—Å–ø–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è

2. **Property 4-12: –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –∏ —Å—Ç–∏–ª–∏–∑–∞—Ü–∏—è**
   - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–ª—É—á–∞–π–Ω—ã—Ö –¥–∞—Ç —Å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è–º–∏
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤ –∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Å—Ç–∏–ª–∏–∑–∞—Ü–∏–∏

3. **Property 13: –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã**
   - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —è—á–µ–µ–∫ —Å —Ä–∞–∑–Ω—ã–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤ (1-10)
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–±–∏–µ–Ω–∏—è –Ω–∞ —Å—Ç—Ä–æ–∫–∏

4. **Property 14-16: Layout –∏ —à–∏—Ä–∏–Ω–∞**
   - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–ª—É—á–∞–π–Ω—ã—Ö —à–∏—Ä–∏–Ω —Å—Ç—Ä–∞–Ω–∏—Ü—ã
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ —Ä–∞—Å—á—ë—Ç–æ–≤

### Integration Tests

**–§–∞–π–ª:** `tests/test_vertical_calendar_integration.py`

1. **–¢–µ—Å—Ç –ø–æ–ª–Ω–æ–≥–æ —Ü–∏–∫–ª–∞ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è**
   - –°–æ–∑–¥–∞–Ω–∏–µ Home_View —Å –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–º –∫–∞–ª–µ–Ω–¥–∞—Ä—ë–º
   - –ö–ª–∏–∫ –Ω–∞ —è—á–µ–π–∫—É
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è Transactions_Panel

2. **–¢–µ—Å—Ç –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –º–µ—Å—è—Ü–µ–≤**
   - –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ —Ä–∞–∑–Ω—ã–µ –º–µ—Å—è—Ü—ã
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –º–µ—Å—è—Ü–∞

3. **–¢–µ—Å—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö**
   - –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π, –ø–ª–∞–Ω–æ–≤—ã—Ö –≤—Ö–æ–∂–¥–µ–Ω–∏–π, –ø–ª–∞—Ç–µ–∂–µ–π
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤ –≤ –∫–∞–ª–µ–Ω–¥–∞—Ä–µ

### UI Tests

**–§–∞–π–ª:** `tests/test_vertical_calendar_ui.py`

1. **–¢–µ—Å—Ç —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞ –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ–≥–æ –∫–∞–ª–µ–Ω–¥–∞—Ä—è**
   - Mock Page –∏ Session
   - –°–æ–∑–¥–∞–Ω–∏–µ Calendar_Widget
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã controls

2. **–¢–µ—Å—Ç –∫–ª–∏–∫–∞ –Ω–∞ —è—á–µ–π–∫—É**
   - Mock callback
   - –°–∏–º—É–ª—è—Ü–∏—è –∫–ª–∏–∫–∞
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—ã–∑–æ–≤–∞ callback —Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –¥–∞—Ç–æ–π

3. **–¢–µ—Å—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ä–∞–∑–º–µ—Ä–∞ –æ–∫–Ω–∞**
   - –ò–∑–º–µ–Ω–µ–Ω–∏–µ page.width
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ—Å—á—ë—Ç–∞ —à–∏—Ä–∏–Ω—ã –∫–∞–ª–µ–Ω–¥–∞—Ä—è

## Implementation Notes

### –ü–æ—Ä—è–¥–æ–∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

1. **–û–±–Ω–æ–≤–∏—Ç—å CalendarWidget**
   - –ò–∑–º–µ–Ω–∏—Ç—å `_build_weekdays_header()`
   - –ò–∑–º–µ–Ω–∏—Ç—å `_update_calendar()` —Å —Ç—Ä–∞–Ω—Å–ø–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ–º
   - –î–æ–±–∞–≤–∏—Ç—å `_build_day_cell()` –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —è—á–µ–µ–∫
   - –û–±–Ω–æ–≤–∏—Ç—å aspect_ratio —è—á–µ–µ–∫ –Ω–∞ 0.7

2. **–û–±–Ω–æ–≤–∏—Ç—å HomeView**
   - –ò–∑–º–µ–Ω–∏—Ç—å –ø—Ä–æ–ø–æ—Ä—Ü–∏–∏ –∫–æ–ª–æ–Ω–æ–∫ –Ω–∞ 2:2:4:3
   - –ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å `pending_payments_widget` –≤–æ –≤—Ç–æ—Ä—É—é –∫–æ–ª–æ–Ω–∫—É
   - –û–±–Ω–æ–≤–∏—Ç—å `_calculate_calendar_width()` –¥–ª—è –ø—Ä–æ–ø–æ—Ä—Ü–∏–∏ 4/11

3. **–û–±–Ω–æ–≤–∏—Ç—å CalendarLegend**
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ —Ä–∞—Å—á—ë—Ç —à–∏—Ä–∏–Ω—ã —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –Ω–æ–≤–æ–π —à–∏—Ä–∏–Ω–æ–π –∫–∞–ª–µ–Ω–¥–∞—Ä—è

4. **–ù–∞–ø–∏—Å–∞—Ç—å —Ç–µ—Å—Ç—ã**
   - Unit —Ç–µ—Å—Ç—ã –¥–ª—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∫–∞–ª–µ–Ω–¥–∞—Ä—è
   - Property-based —Ç–µ—Å—Ç—ã –¥–ª—è –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤
   - Integration —Ç–µ—Å—Ç—ã –¥–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è
   - UI —Ç–µ—Å—Ç—ã –¥–ª—è —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞

5. **–ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ —Ç–µ—Å—Ç—ã**
   - –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç
   - –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –Ω–æ–≤—ã–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç

### –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

1. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø—Ä–∏ –±–æ–ª—å—à–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤**
   - –†–µ—à–µ–Ω–∏–µ: –û–≥—Ä–∞–Ω–∏—á–∏—Ç—å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤ –Ω–∞ —è—á–µ–π–∫—É (–Ω–∞–ø—Ä–∏–º–µ—Ä, 9)

2. **–ß–∏—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç—å –ø—Ä–∏ –æ—á–µ–Ω—å —É–∑–∫–∏—Ö –æ–∫–Ω–∞—Ö**
   - –†–µ—à–µ–Ω–∏–µ: –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –º–∏–Ω–∏–º–∞–ª—å–Ω—É—é —à–∏—Ä–∏–Ω—É –∫–∞–ª–µ–Ω–¥–∞—Ä—è (300px)

3. **–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º–∏ —Ç–µ—Å—Ç–∞–º–∏**
   - –†–µ—à–µ–Ω–∏–µ: –û–±–Ω–æ–≤–∏—Ç—å —Ç–µ—Å—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–æ–≤–µ—Ä—è—é—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∫–∞–ª–µ–Ω–¥–∞—Ä—è

### –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

- –í—Å–µ –ø—É–±–ª–∏—á–Ω—ã–µ –º–µ—Ç–æ–¥—ã `CalendarWidget` –æ—Å—Ç–∞—é—Ç—Å—è –Ω–µ–∏–∑–º–µ–Ω–Ω—ã–º–∏
- –í—Å–µ callbacks –æ—Å—Ç–∞—é—Ç—Å—è –Ω–µ–∏–∑–º–µ–Ω–Ω—ã–º–∏
- –§–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö –Ω–µ –º–µ–Ω—è–µ—Ç—Å—è
- –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

## Performance Considerations

- –¢—Ä–∞–Ω—Å–ø–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –º–∞—Ç—Ä–∏—Ü—ã –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –æ–¥–∏–Ω —Ä–∞–∑ –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –∫–∞–ª–µ–Ω–¥–∞—Ä—è
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ UI –æ—Å—Ç–∞—ë—Ç—Å—è –ø—Ä–∏–º–µ—Ä–Ω–æ —Ç–∞–∫–∏–º –∂–µ (7 —Å—Ç—Ä–æ–∫ √ó 5 —Å—Ç–æ–ª–±—Ü–æ–≤ ‚âà 5 —Å—Ç—Ä–æ–∫ √ó 7 —Å—Ç–æ–ª–±—Ü–æ–≤)
- –†–∞—Å—á—ë—Ç —à–∏—Ä–∏–Ω—ã –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ä–∞–∑–º–µ—Ä–∞ –æ–∫–Ω–∞ –∏–ª–∏ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞
