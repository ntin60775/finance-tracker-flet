# Requirements Document

## Introduction

Создание комплексного набора UI-тестов для Finance Tracker Flet для предотвращения поломок интерфейса при внесении изменений в код. Текущая проблема: при изменениях в коде часто ломается UI, и это обнаруживается только при ручном тестировании. Необходимо автоматизировать проверку базовых пользовательских сценариев для каждого View.

## Glossary

- **View**: Экран приложения (CategoriesView, LoansView, HomeView и т.д.)
- **UI Component**: Элемент интерфейса (кнопка, поле ввода, список и т.д.)
- **Navigation**: Переход между экранами через меню
- **Modal**: Модальное окно для создания/редактирования данных
- **Smoke Test**: Базовый тест, проверяющий, что компонент инициализируется без ошибок
- **User Scenario**: Типичный сценарий использования приложения пользователем
- **Main Window**: Главное окно приложения с навигационным меню

## Requirements

### Requirement 1

**User Story:** Как разработчик, я хочу иметь smoke-тесты для каждого View, чтобы быстро обнаруживать критические ошибки инициализации.

#### Acceptance Criteria

1. WHEN каждый View создается THEN он SHALL инициализироваться без исключений
2. WHEN каждый View создается THEN все обязательные атрибуты (page, session) SHALL быть установлены
3. WHEN каждый View создается THEN основные UI компоненты (заголовок, контейнеры) SHALL быть созданы
4. WHEN тест запускается THEN он SHALL выполняться быстро (менее 1 секунды на View)

### Requirement 2

**User Story:** Как разработчик, я хочу тестировать загрузку данных в каждом View, чтобы убедиться, что сервисы вызываются корректно.

#### Acceptance Criteria

1. WHEN View инициализируется THEN соответствующие сервисы загрузки данных SHALL быть вызваны
2. WHEN View получает данные THEN UI компоненты SHALL быть обновлены
3. WHEN View получает пустой список данных THEN SHALL отображаться сообщение о пустом состоянии
4. WHEN сервис возвращает ошибку THEN View SHALL обработать её корректно

### Requirement 3

**User Story:** Как разработчик, я хочу тестировать фильтрацию данных в View, чтобы убедиться, что фильтры работают правильно.

#### Acceptance Criteria

1. WHEN пользователь меняет фильтр THEN данные SHALL быть перезагружены с новым фильтром
2. WHEN фильтр установлен на "Все" THEN данные SHALL загружаться без фильтрации
3. WHEN фильтр меняется THEN UI SHALL обновиться с новыми данными
4. WHEN фильтр применяется к пустому списку THEN SHALL отображаться сообщение о пустом состоянии

### Requirement 4

**User Story:** Как разработчик, я хочу тестировать открытие модальных окон, чтобы убедиться, что диалоги создания/редактирования работают.

#### Acceptance Criteria

1. WHEN пользователь нажимает кнопку создания THEN модальное окно SHALL открыться в режиме создания
2. WHEN пользователь нажимает кнопку редактирования THEN модальное окно SHALL открыться в режиме редактирования с данными объекта
3. WHEN модальное окно открывается THEN все поля SHALL быть инициализированы корректно
4. WHEN модальное окно закрывается THEN View SHALL обновить данные

### Requirement 5

**User Story:** Как разработчик, я хочу тестировать навигацию между экранами, чтобы убедиться, что меню работает правильно.

#### Acceptance Criteria

1. WHEN пользователь кликает на пункт меню THEN соответствующий View SHALL открыться
2. WHEN View открывается через меню THEN он SHALL инициализироваться корректно
3. WHEN происходит переход между View THEN предыдущий View SHALL корректно закрыться
4. WHEN открывается каждый пункт меню THEN приложение SHALL работать без ошибок

### Requirement 6

**User Story:** Как разработчик, я хочу тестировать CategoriesView, чтобы убедиться в корректности управления категориями.

#### Acceptance Criteria

1. WHEN CategoriesView инициализируется THEN список категорий SHALL быть загружен
2. WHEN пользователь меняет фильтр типа транзакции THEN категории SHALL быть отфильтрованы
3. WHEN пользователь открывает диалог создания категории THEN CategoryDialog SHALL открыться
4. WHEN пользователь открывает диалог редактирования THEN CategoryDialog SHALL открыться с данными категории
5. WHEN пользователь удаляет категорию THEN она SHALL быть удалена и список обновлен

### Requirement 7

**User Story:** Как разработчик, я хочу тестировать LendersView, чтобы убедиться в корректности управления займодателями.

#### Acceptance Criteria

1. WHEN LendersView инициализируется THEN список займодателей SHALL быть загружен
2. WHEN пользователь меняет фильтр типа займодателя THEN займодатели SHALL быть отфильтрованы
3. WHEN пользователь открывает диалог создания займодателя THEN LenderModal SHALL открыться
4. WHEN пользователь открывает диалог редактирования THEN LenderModal SHALL открыться с данными займодателя
5. WHEN пользователь удаляет займодателя с активными кредитами THEN SHALL отображаться ошибка

### Requirement 8

**User Story:** Как разработчик, я хочу тестировать LoansView, чтобы убедиться в корректности управления кредитами.

#### Acceptance Criteria

1. WHEN LoansView инициализируется THEN список кредитов и статистика SHALL быть загружены
2. WHEN пользователь меняет фильтр статуса кредита THEN кредиты SHALL быть отфильтрованы
3. WHEN пользователь открывает диалог создания кредита THEN LoanModal SHALL открыться
4. WHEN пользователь кликает на кредит THEN LoanDetailsView SHALL открыться
5. WHEN статистика обновляется THEN UI SHALL отобразить актуальные данные

### Requirement 9

**User Story:** Как разработчик, я хочу тестировать LoanDetailsView, чтобы убедиться в корректности отображения деталей кредита.

#### Acceptance Criteria

1. WHEN LoanDetailsView инициализируется THEN детали кредита и график платежей SHALL быть загружены
2. WHEN пользователь нажимает кнопку "Назад" THEN SHALL произойти возврат к списку кредитов
3. WHEN кредит не найден THEN SHALL отображаться сообщение об ошибке
4. WHEN загружается график платежей THEN все платежи SHALL быть отображены
5. WHEN пользователь открывает диалог досрочного погашения THEN EarlyRepaymentModal SHALL открыться

### Requirement 10

**User Story:** Как разработчик, я хочу тестировать PendingPaymentsView, чтобы убедиться в корректности управления отложенными платежами.

#### Acceptance Criteria

1. WHEN PendingPaymentsView инициализируется THEN список отложенных платежей и статистика SHALL быть загружены
2. WHEN пользователь выполняет платеж THEN платеж SHALL быть удален из списка и создана транзакция
3. WHEN пользователь отменяет платеж THEN платеж SHALL быть удален из списка
4. WHEN список пуст THEN SHALL отображаться сообщение о пустом состоянии
5. WHEN статистика обновляется THEN UI SHALL отобразить актуальные данные

### Requirement 11

**User Story:** Как разработчик, я хочу тестировать PlannedTransactionsView, чтобы убедиться в корректности управления плановыми транзакциями.

#### Acceptance Criteria

1. WHEN PlannedTransactionsView инициализируется THEN список плановых транзакций SHALL быть загружен
2. WHEN пользователь меняет фильтр типа транзакции THEN транзакции SHALL быть отфильтрованы
3. WHEN пользователь открывает диалог создания транзакции THEN PlannedTransactionModal SHALL открыться
4. WHEN пользователь открывает диалог редактирования THEN PlannedTransactionModal SHALL открыться с данными транзакции
5. WHEN пользователь удаляет транзакцию THEN она SHALL быть удалена и список обновлен

### Requirement 12

**User Story:** Как разработчик, я хочу тестировать PlanFactView, чтобы убедиться в корректности план-факт анализа.

#### Acceptance Criteria

1. WHEN PlanFactView инициализируется THEN данные план-факт анализа SHALL быть загружены
2. WHEN пользователь меняет период THEN данные SHALL быть перезагружены для нового периода
3. WHEN пользователь меняет фильтр категории THEN данные SHALL быть отфильтрованы
4. WHEN данные пусты THEN SHALL отображаться сообщение о пустом состоянии
5. WHEN отображаются отклонения THEN они SHALL быть правильно рассчитаны и отформатированы

### Requirement 13

**User Story:** Как разработчик, я хочу тестировать SettingsView, чтобы убедиться в корректности управления настройками.

#### Acceptance Criteria

1. WHEN SettingsView инициализируется THEN текущие настройки SHALL быть загружены и отображены
2. WHEN пользователь меняет тему THEN тема приложения SHALL измениться и сохраниться
3. WHEN пользователь меняет размеры окна THEN размеры SHALL измениться и сохраниться
4. WHEN пользователь сбрасывает настройки THEN они SHALL вернуться к значениям по умолчанию
5. WHEN настройки сохраняются THEN они SHALL быть доступны после перезапуска

### Requirement 14

**User Story:** Как разработчик, я хочу тестировать HomeView, чтобы убедиться в корректности главного экрана.

#### Acceptance Criteria

1. WHEN HomeView инициализируется THEN календарь, транзакции и плановые операции SHALL быть загружены
2. WHEN пользователь выбирает дату в календаре THEN транзакции для этой даты SHALL быть загружены
3. WHEN пользователь меняет месяц THEN данные календаря SHALL обновиться
4. WHEN пользователь открывает диалог создания транзакции THEN TransactionModal SHALL открыться
5. WHEN транзакция создается THEN календарь и список транзакций SHALL обновиться
